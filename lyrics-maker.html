<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ЁЯО╡ Lyrics Maker - Stable Version</title>
    <style>
        body { font-family: sans-serif; background: #FFF3E0; text-align: center; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #FF9800; max-width: 600px; margin: auto; }
        
        /* рдмрдбрд╝рд╛ рдорд╛рдЗрдХ рдмрдЯрди */
        .mic-btn {
            width: 100px; height: 100px; border-radius: 50%; border: none;
            font-size: 3rem; cursor: pointer; margin: 20px 0;
            background: #D32F2F; color: white;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2); transition: 0.3s;
        }
        .mic-btn.active { background: #2ecc71; animation: pulse 1.5s infinite; }
        
        textarea { width: 100%; height: 200px; padding: 10px; font-size: 1.1rem; border: 2px solid #FFCC80; border-radius: 10px; box-sizing: border-box; }
        .status { color: #D84315; font-weight: bold; margin-bottom: 10px; min-height: 25px; }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; color: white; margin: 5px; font-size: 1rem; }
        .copy-btn { background: #FF9800; }
        .clear-btn { background: #555; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="container">
        <h2>ЁЯОЩя╕П рд╣рд┐рдВрджреА рд▓рд┐рд░рд┐рдХреНрд╕ рдореЗрдХрд░</h2>
        <p>рдорд╛рдЗрдХ рджрдмрд╛рдПрдВ рдФрд░ рд╕реНрдкрд╖реНрдЯ рдмреЛрд▓реЗрдВ (рдпрд╛ рдЧрд╛рдирд╛ рдЪрд▓рд╛рдПрдВ)</p>

        <div class="status" id="statusText">рдорд╛рдЗрдХ рдмрдВрдж рд╣реИ</div>

        <button onclick="toggleMic()" class="mic-btn" id="micBtn">ЁЯОЩя╕П</button>

        <textarea id="finalText" placeholder="рдмреЛрд▓ рдпрд╣рд╛рдБ рдЖрдПрдВрдЧреЗ..."></textarea>

        <br>
        <button onclick="copyText()" class="btn copy-btn">ЁЯУЛ рдХреЙрдкреА</button>
        <button onclick="document.getElementById('finalText').value=''" class="btn clear-btn">ЁЯЧСя╕П рд╕рд╛реЮ</button>
    </div>

    <script>
        const micBtn = document.getElementById('micBtn');
        const statusText = document.getElementById('statusText');
        const textArea = document.getElementById('finalText');

        let recognition;
        let isListening = false;

        // рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рдкреЛрд░реНрдЯ рдЪреЗрдХ
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();

            recognition.continuous = false; // рдореЛрдмрд╛рдЗрд▓ рдкрд░ 'True' рд╣реЛрдиреЗ рд╕реЗ рдмреАрдк рд▓реВрдк рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП False рд░рдЦрд╛ рд╣реИ
            recognition.interimResults = false; // рд╕рд┐рд░реНрдл рдлрд╛рдЗрдирд▓ рд╢рдмреНрдж рджрд┐рдЦрд╛рдПрдЧрд╛
            recognition.lang = 'hi-IN'; // рд╣рд┐рдВрджреА рднрд╛рд╖рд╛

            // рдЬрдм рдорд╛рдЗрдХ рд╢реБрд░реВ рд╣реЛ
            recognition.onstart = function() {
                isListening = true;
                micBtn.classList.add('active');
                micBtn.innerHTML = "ЁЯСВ";
                statusText.innerText = "рд╕реБрди рд░рд╣рд╛ рд╣реВрдБ...";
            };

            // рдЬрдм рдорд╛рдЗрдХ рдЕрдкрдиреЗ рдЖрдк рдмрдВрдж рд╣реЛ рдЬрд╛рдП (рдмреЛрд▓рдирд╛ рдЦрддреНрдо рд╣реЛрдиреЗ рдкрд░)
            recognition.onend = function() {
                micBtn.classList.remove('active');
                micBtn.innerHTML = "ЁЯОЩя╕П";
                statusText.innerText = "рд░реБрдХ рдЧрдпрд╛ (рджреБрдмрд╛рд░рд╛ рджрдмрд╛рдПрдВ)";
                
                // рдореЛрдмрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЬреБрдЧрд╛реЬ: рдЕрдЧрд░ рдпреВрдЬрд░ рдиреЗ рдмрдВрдж рдирд╣реАрдВ рдХрд┐рдпрд╛, рддреЛ 1 рд╕реЗрдХрдВрдб рдмрд╛рдж рдлрд┐рд░ рдЪрд▓рд╛рдУ
                if (isListening) {
                    setTimeout(() => { 
                        try { recognition.start(); } catch(e) {} 
                    }, 1000); // 1 рд╕реЗрдХрдВрдб рдХрд╛ рдмреНрд░реЗрдХ рддрд╛рдХрд┐ рдмреАрдк-рдмреАрдк рди рд╣реЛ
                }
            };

            // рдЬрдм рд░рд┐рдЬрд▓реНрдЯ рдЖрдП
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                textArea.value += transcript + "ред\n";
            };

            // рдЕрдЧрд░ рдХреЛрдИ рдПрд░рд░ рдЖрдП
            recognition.onerror = function(event) {
                console.log("Error:", event.error);
                if(event.error === 'no-speech') {
                    statusText.innerText = "рдХреБрдЫ рд╕реБрдирд╛рдИ рдирд╣реАрдВ рджрд┐рдпрд╛...";
                } else {
                    statusText.innerText = "Error: " + event.error;
                    isListening = false; // рдПрд░рд░ рдЖрдиреЗ рдкрд░ рд▓реВрдк рдмрдВрдж рдХрд░ рджреЛ
                }
            };

        } else {
            alert("рдЖрдкрдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рдкреЛрд░реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ред Chrome рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░реЗрдВред");
        }

        // рдмрдЯрди рджрдмрд╛рдиреЗ рдкрд░ рдХреНрдпрд╛ рд╣реЛ
        function toggleMic() {
            if (!recognition) return;

            if (isListening) {
                isListening = false;
                recognition.stop();
            } else {
                isListening = true;
                recognition.start();
            }
        }

        function copyText() {
            textArea.select();
            document.execCommand('copy');
            alert("рдХреЙрдкреА рд╣реЛ рдЧрдпрд╛!");
        }
    </script>

</body>
</html>
